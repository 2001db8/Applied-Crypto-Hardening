\section{Cipher suites}


\subsection{Recommended cipher suites}

In principle, system administrators who want to improve their servers need to
make a hard decision between locking out some users while keeping very high
cipher suite security levels or supporting as many users as possible while
lowering some settings. \url{https://www.ssllabs.com/} gives administrators a
tool to test out different settings. The authors used ssllabs.com to arrive at
a set of cipher suites which we will recommend throught this document.
\textbf{Caution: these settings can only represent a subjective choice of the
authors at the time of this writing. It might be a wise choice to select your
own ciper suites based on the instructions in section
\ref{section:ChosingYourOwnCipherSuites}}.


\subsubsection{Configuration A: strong ciphers, fewer clients}

At the time of this writing, we recommend the following set of strong cipher suites which may be useful in an environment where you do not depend on many, diverse external clients and where compatibility is not an issue.  An example of such an environment might be machine 2 machine communications or corporate environments where you can define the software which must be used.


We arrived at this set of cipher suites by selecting

\begin{itemize}
\item TLS 1.2
\item Perfect forward secrecy / ephemeral Diffie Hellman
\item strong Hashes (SHA-2)
\item GCM as chaining mode if possible 
\end{itemize}

This results in the string:

\begin{verbatim}
EECDH+aRSA+AES256:EDH+aRSA+AES256:!SSLv3
\end{verbatim}

%$\implies$ resolves to 
%
%\begin{verbatim}
%openssl ciphers -V $string
%\end{verbatim}



\begin{center}
\begin{tabular}{| l | l | l | l | l| l | l |}
\hline
ID        & OpenSSL name                & Version & KeyEx & Auth & Cipher & Hash \\ \hline
0xC030 & ECDHE-RSA-AES256-GCM-SHA384 & TLSv1.2 & ECDH  &  RSA &AESGCM(256)  & AEAD   \\ \hline
0xC028 & ECDHE-RSA-AES256-SHA384     & TLSv1.2 & ECDH  &  RSA &AES(256)     & SHA384 \\ \hline
0x009F & DHE-RSA-AES256-GCM-SHA384   & TLSv1.2 & DH    &  RSA &AESGCM(256)  & AEAD   \\ \hline
0x006B & DHE-RSA-AES256-SHA256       & TLSv1.2 & DH    &  RSA &AES(256)     & SHA256 \\ \hline
\end{tabular}
\end{center}


Compatibility:

Only clients which support TLS1.2 are covered by this cipher suites (Chrome 30, Win 7 and Win 8.1 crypto stack, Opera 17, OpenSSL >= 1.0.1e, Safari 6 / iOS 6.0.1, Safari 7 / OS X 10.9).



\subsubsection{Configuration B: weaker ciphers, many clients}

TLS 1.2, TLS 1.1, TLS 1.0, -SSLv3, -SSLv2

\todo{HOW did we arrive at this string? Constraints: which clients are supported by this string? }

string="EECDH+aRSA+AESGCM:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EDH+CAMELLIA256:EECDH:EDH+aRSA:+SSLv3:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!RC4:!SEED:!AES128:!CAMELLIA128:!ECDSA:AES256-SHA"


$\implies$ resolves to openssl ciphers -V \$string

\begin{center}
\begin{tabular}{| l | l | l | l | l| l | l |}
\hline
ID        & OpenSSL name			    & Version & KeyEx & Auth & Cipher & Hash \\ \hline
0xC030 & ECDHE-RSA-AES256-GCM-SHA384 & TLSv1.2 & ECDH  &  RSA &AESGCM(256)  & AEAD   \\ \hline
0xC028 & ECDHE-RSA-AES256-SHA384     & TLSv1.2 & ECDH  &  RSA &AES(256)     & SHA384 \\ \hline
0x009F & DHE-RSA-AES256-GCM-SHA384   & TLSv1.2 & DH    &  RSA &AESGCM(256)  & AEAD   \\ \hline
0x006B & DHE-RSA-AES256-SHA256       & TLSv1.2 & DH    &  RSA &AES(256)     & SHA256 \\ \hline
0x0088 & DHE-RSA-CAMELLIA256-SHA     & SSLv3   & DH    &  RSA &Camellia(256)& SHA1   \\ \hline
0xC014 & ECDHE-RSA-AES256-SHA        & SSLv3   & ECDH  &  RSA &AES(256)     & SHA1   \\ \hline
0x0039 & DHE-RSA-AES256-SHA          & SSLv3   & DH    &  RSA &AES(256)     & SHA1   \\ \hline
0x0035 & AES256-SHA                  & SSLv3   & RSA   &  RSA &AES(256)     & SHA1   \\ \hline

\end{tabular}
\end{center}

Compatibility:

Note that this cipher suites will not work with anything using Windows XP's crypto stack (IE, Outlook), Java 6, Java 7 and Android 2.3. Java 7 could be made compatible by installing the "Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files" (JCE). We could not verify yet if installing JCE also fixes the Java 7 DH-parameter length limitation (1024 bit). 



\subsection{Chosing your own cipher suites}
\label{section:ChosingYourOwnCipherSuites}
\todo{ Adi... }

